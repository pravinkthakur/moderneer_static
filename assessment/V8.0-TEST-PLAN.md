# V8.0 API-First Architecture - Test Plan

## Overview
Test plan for the v8.0 API-first architecture update that removed all hardcoded data from boot.js.

## Pre-Test Checklist

‚úÖ boot.js updated to v8.0 (no hardcoded data)
‚úÖ Vercel configuration updated (.vercelignore + vercel.json)
‚úÖ API endpoints deployed and accessible
‚úÖ Files backed up (boot-v7-backup.js exists)

## Test Environment

**Frontend URL:** `file:///c:/moderneer/moderneer_static/assessment/index.html` (local) or `https://moderneer.co.uk/assessment` (live)
**API Base URL:** `https://api.assessment.config.moderneer.co.uk`

## Test Suite

### 1. Browser Console Tests

Open DevTools Console (F12) and verify:

**Expected Console Output:**
```
üîß Assessment Data Loader initialized
üì° Loading from API server: https://api.assessment.config.moderneer.co.uk
‚úÖ Loaded config from API server successfully!
‚úÖ Loaded 11 scales from API
‚úÖ Built purpose map for 8 prefixes
üîß Building PARAM_META from API parameters...
‚úÖ Loaded 60+ parameters from API
‚úÖ MODEL built successfully with API data
```

**Check for Errors:**
- ‚ùå No "ReferenceError: LEGACY_MODEL_PARAMETERS is not defined"
- ‚ùå No "SCALE_CATALOG is undefined"
- ‚ùå No "DEFAULT_PURPOSE_BY_PREFIX is undefined"
- ‚ùå No CORS errors
- ‚ùå No 404 errors from API

### 2. API Endpoint Tests

Test each endpoint returns proper data:

```powershell
# Test from PowerShell
$base = "https://api.assessment.config.moderneer.co.uk"

# 1. Config endpoint
Invoke-RestMethod "$base/config" | ConvertTo-Json

# 2. Pillars endpoint
Invoke-RestMethod "$base/pillars" | ConvertTo-Json

# 3. Scales endpoint
Invoke-RestMethod "$base/scales" | ConvertTo-Json

# 4. Rules endpoint
Invoke-RestMethod "$base/rules" | ConvertTo-Json

# 5. Parameters endpoint
Invoke-RestMethod "$base/parameters" | ConvertTo-Json
```

**Expected Response Format:**
```json
{
  "success": true,
  "data": {
    // ... endpoint-specific data
  }
}
```

### 3. UI Rendering Tests

#### 3.1 Parameter Loading
- [ ] All parameters render in the sidebar
- [ ] Parameter labels show correctly (not IDs)
- [ ] Tier badges display (T1, T2, T3)
- [ ] Checkboxes are clickable
- [ ] Hover tooltips show parameter descriptions

#### 3.2 Scale Loading
- [ ] Scale dropdowns populate with values
- [ ] Scale anchors show correct text
- [ ] All 11 scales are available
- [ ] Default values pre-select correctly

#### 3.3 Pillar Display
- [ ] All 8 pillars show in results
- [ ] Pillar weights display correctly
- [ ] Pillar purpose text matches API data

### 4. Functionality Tests

#### 4.1 Parameter Selection
1. Click various parameter checkboxes
2. Verify they toggle on/off
3. Check localStorage updates: `localStorage.getItem('assessmentState')`
4. Verify checked parameters highlight in UI

#### 4.2 Scale Selection
1. Change scale dropdowns
2. Verify values update
3. Check localStorage saves selections
4. Verify scale descriptions show

#### 4.3 Compute Scores
1. Select at least 5 parameters
2. Set scale values
3. Click "Compute Scores" button
4. Verify:
   - [ ] Scores calculate for each pillar
   - [ ] Overall score displays
   - [ ] Score bars render
   - [ ] Maturity level shows

#### 4.4 Generate Report
1. After computing scores, click "Generate Report"
2. Verify:
   - [ ] Report modal opens
   - [ ] All selected parameters appear
   - [ ] Scale values display
   - [ ] Pillar scores shown
   - [ ] Recommendations included

#### 4.5 Save/Load
1. Make selections and compute
2. Click "Save Assessment"
3. Refresh page
4. Click "Load Assessment"
5. Verify all previous selections restored

#### 4.6 Export/Import
1. Click "Export JSON"
2. Save file
3. Clear assessment
4. Click "Import JSON"
5. Load saved file
6. Verify assessment restored

### 5. Edge Case Tests

#### 5.1 API Failure Handling
1. Block network requests (DevTools ‚Üí Network ‚Üí Offline)
2. Refresh page
3. Verify:
   - [ ] Error message shows
   - [ ] Graceful degradation
   - [ ] Retry option available

#### 5.2 Partial Data Loading
1. If API returns partial data, verify:
   - [ ] App doesn't crash
   - [ ] Available data still renders
   - [ ] Missing data has fallbacks

#### 5.3 Invalid Data Handling
1. Test with malformed parameter selections
2. Verify validation prevents compute

### 6. Performance Tests

#### 6.1 Load Time
- [ ] Page loads in < 2 seconds
- [ ] API calls complete in < 1 second each
- [ ] No blocking rendering

#### 6.2 Compute Time
- [ ] Score calculation completes in < 500ms
- [ ] UI remains responsive

#### 6.3 Memory Usage
- [ ] No memory leaks after multiple compute cycles
- [ ] Console memory profile stays stable

### 7. Cross-Browser Tests

Test in:
- [ ] Chrome/Edge (Chromium)
- [ ] Firefox
- [ ] Safari (if available)

### 8. Mobile Responsiveness

Test on mobile viewport:
- [ ] UI scales properly
- [ ] Touch interactions work
- [ ] Dropdowns accessible
- [ ] Report modal readable

## Regression Tests

Verify no breaking changes:

- [ ] URL parameters still work (`?preset=basic`)
- [ ] Keyboard shortcuts functional
- [ ] Print styles work
- [ ] Accessibility features intact
- [ ] Analytics tracking fires

## Vercel Deployment Test

```powershell
cd c:\moderneer\moderneer-platform\services\assessment-config-service
vercel --prod
```

**Expected:**
```
‚úÖ Deployment ready
üîó Production: https://api.assessment.config.moderneer.co.uk
```

**Verify:**
- [ ] Build completes without errors
- [ ] No "npx failed" error
- [ ] All endpoints return 200 OK
- [ ] CORS headers present

## Data Validation Tests

### Verify API Data Integrity

**Scales Check:**
```javascript
// In browser console
Object.keys(SCALE_CATALOG).length === 11  // Should be true
console.table(SCALE_CATALOG)
```

**Parameters Check:**
```javascript
// In browser console
Object.keys(MODEL.parameters).length >= 60  // Should be true
console.table(Object.values(MODEL.parameters).map(p => ({
  id: p.id,
  label: p.label,
  tier: p.tier,
  checks: p.checks?.length || 0
})))
```

**Pillars Check:**
```javascript
// In browser console
MODEL.pillars.length === 8  // Should be true
console.table(MODEL.pillars.map(p => ({
  id: p.id,
  weight: p.weight,
  purpose: p.purpose?.substring(0, 50)
})))
```

## Issue Tracking

### If Tests Fail

1. **Check Console for Errors**
   - Note exact error message
   - Check line number in boot.js
   - Verify API endpoint response

2. **Verify API Endpoints**
   - Test each endpoint individually
   - Check response format
   - Verify CORS headers

3. **Rollback if Needed**
   ```powershell
   cd c:\moderneer\moderneer_static\assessment\src\app
   Copy-Item boot-v7-backup.js boot.js
   ```

4. **Report Issues**
   - Document what failed
   - Include console errors
   - Note browser/OS
   - Attach network trace

## Success Criteria

All tests must pass:
- ‚úÖ No console errors
- ‚úÖ All API endpoints return data
- ‚úÖ All UI elements render correctly
- ‚úÖ Compute functionality works
- ‚úÖ Report generation works
- ‚úÖ Save/load works
- ‚úÖ Export/import works
- ‚úÖ Vercel deployment succeeds

## Sign-Off

**Test Date:** _____________
**Tester:** _____________
**Result:** ‚úÖ PASS / ‚ùå FAIL
**Notes:** _____________

---

**Version:** 8.0.0
**Last Updated:** 2025-01-20
