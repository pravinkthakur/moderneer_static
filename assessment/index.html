<!doctype html>
<html lang="en">
<head>
  <meta http-equiv="Content-Security-Policy" content="default-src 'self' data: blob:; script-src 'self' 'unsafe-inline' blob:; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; font-src 'self' https://fonts.gstatic.com; img-src 'self' data:; connect-src 'self' https://api.openai.com https://assessment-compute-service.vercel.app https://api.assessment.compute.moderneer.co.uk">
  <meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Assessment — Moderneer</title>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../css/modern-2025.css">
  <link rel="stylesheet" href="moderneer.css" />
  <meta name="description" content="Outcome Engineering Maturity Assessment | Moderneer">
  <meta name="theme-color" content="#3B82F6" />
</head>
<body>

<!-- Header Include -->
<div id="header-include"></div>

<main class="container" role="main">
  <div class="assessment-grid" data-testid="main">
    <section class="assessment-card">
    <div class="modern-toolbar">
      <!-- Assessment Mode Selection -->
      <div class="control-card">
        <h3 class="card-title">Assessment Mode</h3>
        <div class="toggle-group" role="tablist" aria-label="Module selector">
          <button id="btnCore" class="toggle-btn active" aria-selected="true" data-testid="mode-core">
            <span class="btn-icon">📊</span>Core 24
          </button>
          <button id="btnFull" class="toggle-btn" aria-selected="false" data-testid="mode-full">
            <span class="btn-icon">📈</span>Full 12 Pillars
          </button>
        </div>
      </div>

      <!-- View Options -->
      <div class="control-card">
        <h3 class="card-title">View Options</h3>
        <div class="toggle-group" role="tablist" aria-label="View selector">
          <button id="btnViewPillar" class="toggle-btn active" aria-selected="true">
            <span class="btn-icon">🏛️</span>By Pillar
          </button>
          <button id="btnViewTier" class="toggle-btn" aria-selected="false">
            <span class="btn-icon">🎯</span>By Tier
          </button>
        </div>
        <div class="toggle-group" role="tablist" aria-label="Mode selector" style="margin-top: 12px;">
          <button id="btnModeAll" class="toggle-btn active" aria-selected="true">
            <span class="btn-icon">📋</span>All
          </button>
          <button id="btnModeSingle" class="toggle-btn" aria-selected="false">
            <span class="btn-icon">🎯</span>One at a time
          </button>
        </div>
      </div>

      <!-- Actions -->
      <div class="control-card">
        <h3 class="card-title">Actions</h3>
        <div class="action-group">
          <button class="modern-btn primary" id="btnCompute" data-testid="compute">
            <span class="btn-icon">⚡</span>Compute (Client)
          </button>
          <button class="modern-btn info" id="btnComputeAPI" data-testid="compute-api" style="margin-top: 8px;">
            <span class="btn-icon">🌐</span>Compute (API)
          </button>
          <div class="compute-status" id="lastCompute" data-testid="last-compute">Last compute: never</div>
        </div>
      </div>

      <!-- Reports & Export -->
      <div class="control-card">
        <h3 class="card-title">Reports & Export</h3>
        <div class="button-grid">
          <button class="modern-btn success" id="btnReport" data-testid="report">
            <span class="btn-icon">📄</span>Generate Report
          </button>
          <button class="modern-btn secondary" id="btnSave" data-testid="save">
            <span class="btn-icon">💾</span>Save
          </button>
          <button class="modern-btn secondary" id="btnLoad" data-testid="load">
            <span class="btn-icon">📁</span>Load
          </button>
          <button class="modern-btn warning" id="btnReset">
            <span class="btn-icon">🔄</span>Reset
          </button>
          <button class="modern-btn secondary" id="btnExport" data-testid="export">
            <span class="btn-icon">📤</span>Export JSON
          </button>
          <button id="btnHelp" class="modern-btn info" aria-label="Open help and legend">
            <span class="btn-icon">❓</span>Help / Legend
          </button>
        </div>
      </div>
    </div>

    <div class="tiny" style="margin-top:6px">
      <b>Scales carry purpose:</b> click ⓘ to see why a measure exists & anchor definitions (e.g., P95 lead time 0=≥20d … 5=≤1d).
      <br/>Index→Scale: 0–25→1..2, 25–50→2..3, 50–80→3..4, 80–100→4..5. Gates & caps apply after weighting.
    </div>

    <div id="formArea"></div>
  </section>

    <aside class="assessment-card" style="display:none">
    <h2 class="h3">Results</h2>
    <div class="kpis">
      <div class="kpi"><div class="tiny">Overall (index 0–100)</div><strong id="overallIndex" data-testid="overall-index">—</strong></div>
      <div class="kpi"><div class="tiny">Overall (scale 1–5)</div><strong id="overallScale">—</strong></div>
      <div class="kpi"><div class="tiny">Band</div><strong id="overallBand">—</strong></div>
      <div class="kpi"><div class="tiny">Gates passed</div><strong id="gatesPassed">—</strong></div>
    </div>

    <div style="margin-top:10px">
      <h3 class="h3">Gate & cap diagnostics</h3>
      <div id="gateList" style="display:grid;gap:10px"></div>
    </div>

    <div style="margin-top:10px">
      <h3 class="h3">Breakdown</h3>
      <div id="pillarBreakdown" style="display:grid;gap:10px"></div>
    </div>
    </aside>
  </div>
</main>

<!-- Modal -->
<div class="overlay" id="overlay">
  <div class="modal">
    <header><strong id="modalTitle">Details</strong><button class="x" id="modalClose">Close</button></header>
    <div class="content" id="modalContent"></div>
  </div>
</div>

<!-- Footer Include -->
<div id="footer-include"></div>
<script src="js/includes.js"></script>
<script src="src/app/inline_legacy.js"></script>


<script src="src/app/boot.js"></script>
<script src="src/compute-api.js"></script>
<script src="src/boot-api-compute.js"></script>




  <script type="module" src="src/main.js"></script>

  <script type="module" src="src/l3_boot.js"></script>

  <script type="module" src="src/perf/boot_perf.js"></script>

  <script type="module" src="src/state/boot_state.js"></script>

  <script type="module" src="src/llm/boot_llm.js"></script>
</body>
</html>